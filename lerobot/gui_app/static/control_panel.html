<!doctype html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LeRobot | Control Panel</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="icon" type="image/webp" href="/static/images/lerobot-icon.webp">
    <style>
      /* Hides scrollbar for Webkit browsers (Chrome, Safari, Edge) */
      #logsDisplay::-webkit-scrollbar {
        display: none;
      }
    </style>
  </head>

  <body> 

    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-xxl bd-gutter">
        <a class="navbar-brand" href="#">
          <img src="/static/images/lerobot-icon.webp" alt="Logo" width="40" height="34" class="d-inline-block me-2">
          <strong>LeRobot Control Panel</strong>
        </a>
      </div>
    </nav>

    <div class="container-fluid d-flex justify-content-center" id="cameraContainer">
      <!-- cam feeds will be dynamically populated here -->
      <p>No Cameras found !!</p>
            
      <!-- sample -->
      <!-- <div class="card">
          <div class="card-body">
            <p class="card-text">cam name</p>
          </div>
          <img src="https://plus.unsplash.com/premium_photo-1669357657874-34944fa0be68?q=80&w=3870&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" class="card-img-bottom" alt="">
      </div>  -->
    </div>

    <div class="container">
      <div class="row">

        <div class="col-6">
          <div class="container p-4">

            <ul class="nav nav-tabs mb-3" id="myTab" role="tablist">
                <li class="nav-item " role="presentation">
                  <button class="nav-link" id="teleop-tab" data-bs-toggle="tab" data-bs-target="#teleop-tab-pane" type="button" role="tab" aria-controls="teleop-tab-pane" aria-selected="true">Teleop</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="record-tab" data-bs-toggle="tab" data-bs-target="#record-tab-pane" type="button" role="tab" aria-controls="record-tab-pane" aria-selected="false">Record</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link active" id="eval-tab" data-bs-toggle="tab" data-bs-target="#eval-tab-pane" type="button" role="tab" aria-controls="eval-tab-pane" aria-selected="false">Evaluate</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="replay-tab" data-bs-toggle="tab" data-bs-target="#replay-tab-pane" type="button" role="tab" aria-controls="replay-tab-pane" aria-selected="false" disabled>Replay</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="calibrate-tab" data-bs-toggle="tab" data-bs-target="#calibrate-tab-pane" type="button" role="tab" aria-controls="calibrate-tab-pane" aria-selected="false" disabled>Calibrate</button>
                </li>
            </ul>

            <div class="tab-content" id="myTabContent">
    
                <!-- teleop controls tab-->
                <div class="tab-pane fade" id="teleop-tab-pane" role="tabpanel" aria-labelledby="teleop-tab" tabindex="0">
                    <div class="container">
    
                      <!-- teleop control buttons -->
                      <div class="card" style="background-color: var(--bs-gray-800)!important">
                          <h6 class="card-header p-3">Mode Controls</h6>
                          <div class="card-body">  
                            <button class="btn btn-primary me-2" id="startTeleopBtn"><i class="bi bi-arrow-repeat"></i> Start Teleop</button>
                            <button class="btn btn-danger me-2" id="stopTeleopBtn"><i class="bi bi-ban"></i> Stop Teleop</button>
    
                          </div>
                      </div>
    
                      <!-- teleop configuration -->
                      <div class="accordion mt-lg-4" id="teleopAccordians">
                        <div class="accordion-item">
                          <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                              Config
                            </button>
                          </h2>
                          <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#teleopAccordians">
                            <div class="accordion-body" style="background-color: var(--bs-gray-800)!important">
    
                              <!-- configs -->
                              <form id="teleopConfigForm" action="/robot/telop/config-update" method="post">
    
                                <div class="mb-3">
                                  <label for="robotConfigSelect" class="form-label">Robot Config File</label>
                                  <select id="robotConfigSelect" class="form-select" name="robot_config"></select>
                                </div>
    
                                <div class="row g-3 align-items-center mb-3">
                                  <div class="col-auto">
                                    <label for="teleopFPS" class="col-form-label">FPS</label>
                                  </div>
                                  <div class="col-auto">
                                    <input type="number" id="teleopFPS" name="fps" class="form-control" aria-describedby="teleopHelpInline" value=30>
                                  </div>
                                </div>
    
                                <button type="submit" class="btn btn-primary">Apply</button>
                              </form>
    
                            </div>
                          </div>
                        </div>                        
                      </div>
                    </div>
                </div>
                
                <!-- record controls tab-->
                <div class="tab-pane fade" id="record-tab-pane" role="tabpanel" aria-labelledby="record-tab" tabindex="1">
                  <div class="container">

                    <!-- record control buttons -->
                    <div class="card" style="background-color: var(--bs-gray-800)!important">
                        <h6 class="card-header p-3">Mode Controls</h6>
                        <div class="card-body">
    
                          <button class="btn btn-primary me-2" id="startRecordSessionBtn"><i class="bi bi-arrow-repeat"></i> Start Session</button>
                          <button class="btn btn-danger me-2" id="stopRecordSessionBtn"><i class="bi bi-ban"></i> Stop Session</button>
    
                          <hr>
                          <div class="mt-3">
    
                            <button class="btn btn-success me-2" id="startRecordBtn"><i class="bi bi-record-fill"></i> Record</button>                                    
                            <button class="btn btn-primary me-2" id="finishRecordBtn"><i class="bi bi-save-fill "></i> Finish</button>
                            <button class="btn btn-danger me-2" id="cancelRecordBtn"><i class="bi bi-trash3-fill"></i> Cancel</button>
    
                          </div>    
                        </div>
                    </div>
    
                    <!-- record configuration -->
                    <div class="accordion mt-lg-4" id="recordAccordian">
    
                      <div class="accordion-item">
    
                        <h2 class="accordion-header">
                          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRecordTab" aria-expanded="true" aria-controls="collapseRecordTab">
                            Config
                          </button>
                        </h2>
    
                        <div id="collapseRecordTab" class="accordion-collapse collapse" data-bs-parent="#recordAccordian">
                          <div class="accordion-body" style="background-color: var(--bs-gray-800)!important">
    
                            <!-- configs -->
                            <form id="recordConfigForm" action="/robot/record/config-update" method="post">
    
                              <div class="mb-3">
                                <label for="robotConfigSelect" class="form-label">Robot Config File</label>
                                <select id="robotConfigSelect" class="form-select" name="robot_config"></select>
                              </div>   
                              
                              <hr>
    
                              <!-- <div class="row g-3 align-items-center mb-3">
                                <div class="col-auto">
                                  <label for="recordRoot" class="col-form-label">Root Dir</label>
                                </div>
                                <div class="col-auto">
                                  <input type="text" id="recordRoot" name="root_dir" class="form-control" aria-describedby="recordHelpline" value="data/">
                                </div>
                              </div> -->

                              <label for="recordRoot" class="form-label">Root Dir</label>
                              <input type="text" id="recordRoot" name="root_dir" class="form-control" aria-describedby="recordHelpline" value="data/">
                              <!-- <div id="passwordHelpBlock" class="form-text">
                                Your password must be 8-20 characters long, contain letters and numbers, and must not contain spaces, special characters, or emoji.
                              </div> -->
    
                              <label for="recordRepoID" class="form-label mt-2">Repo ID</label>
                              <input type="text" id="recordRepoID" name="repo_id" class="form-control" aria-describedby="recordHelpline" value="default/dataset">
    
                              <label for="recordTags" class="form-label mt-2">Tags</label>
                              <input type="text" id="recordTags" name="tags" class="form-control" aria-describedby="recordHelpline" value="">
    
                              <label for="recordSingleTask" class="form-label mt-2">Single Task Desc</label>
                              <input type="text" id="recordSingleTask" name="single_task" class="form-control" aria-describedby="recordHelpline" value="">
    
                              <label for="recordNumEpisodes" class="form-label mt-2">Num Episodes</label>
                              <input type="number" id="recordNumEpisodes" name="num_episodes" class="form-control" aria-describedby="number of episodes" value="50">
                              
                              <hr>
                              <div class="container mb-2 d-flex flex-wrap">
    
                                <div class="form-check form-switch" style="margin-right: 10px;">
                                  <input class="form-check-input" name="resume" type="checkbox" role="switch" id="resumeRecordToggle">
                                  <label class="form-check-label" for="resumeRecordToggle">Resume</label>
                                </div>
    
                                <div class="form-check form-switch" style="margin-right: 10px;">
                                  <input class="form-check-input" name="local_files_only" type="checkbox" role="switch" id="recordLocalFilesToggle">
                                  <label class="form-check-label" for="recordLocalFilesToggle">Local Files Only</label>
                                </div>
    
                                <div class="form-check form-switch mb-3">
                                  <input class="form-check-input" name="run_compute_stats" type="checkbox" role="switch" id="recordRunComputeStats" checked>
                                  <label class="form-check-label" for="recordRunComputeStats">Run Compute Stats</label>
                                </div>
    
                                <div class="form-check form-switch mb-3">
                                  <input class="form-check-input" name="push_to_hub" type="checkbox" role="switch" id="recordPushToHub">
                                  <label class="form-check-label" for="recordPushToHub">Push To Hub</label>
                                </div>
    
                              </div>                                     
                              
    
                              <div class="input-group mb-3">
                                <span class="input-group-text">Max Episode Time</span>
                                <input type="number" class="form-control" id="recordEpisodeTime" name="episode_time_s" value="40" aria-label="episode time">
                                <span class="input-group-text">FPS</span>
                                <input type="number" class="form-control" id="recordFPS" name="fps" value="30" aria-label="frames per second">
                              </div>
    
                              
    
                              <div class="input-group mb-3">
                                <span class="input-group-text">Image Writer Processes</span>
                                <input type="number" class="form-control" id="recordImageWriterProcesses" name="num_image_writer_processes" value="0" aria-label="number of processes for image writer">
                                <span class="input-group-text">Writer Threads</span>
                                <input type="number" class="form-control" id="recordImageWriterThreads" name="num_image_writer_threads_per_camera" value="4" aria-label="number of threads for image writer">
                              </div>
    
    
                              <button type="submit" class="btn btn-primary">Apply</button>
    
                            </form>
    
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="tab-pane fade show active" id="eval-tab-pane" role="tabpanel" aria-labelledby="eval-tab" tabindex="2">

                  <!-- eval control buttons -->
                  <div class="card" style="background-color: var(--bs-gray-800)!important">
                    <h6 class="card-header p-3">Mode Controls</h6>
                    <div class="card-body">  
                      <button class="btn btn-primary me-2" id="startEvalBtn"><i class="bi bi-arrow-repeat"></i> Start Evaluation</button>
                      <button class="btn btn-danger me-2" id="stopEvalBtn"><i class="bi bi-ban"></i> Stop Evaluation</button>

                    </div>
                  </div>

                  <!-- eval configuration -->
                  <div class="accordion mt-lg-4" id="evalAccordian">
    
                    <div class="accordion-item">
  
                      <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEvalTab" aria-expanded="true" aria-controls="collapseEvalTab">
                          Config
                        </button>
                      </h2>
  
                      <div id="collapseEvalTab" class="accordion-collapse collapse" data-bs-parent="#evalAccordian">
                        <div class="accordion-body" style="background-color: var(--bs-gray-800)!important">
  
                          <!-- configs -->
                          <form id="evalConfigForm" action="/robot/eval/config-update" method="post">
  
                            <div class="mb-3">
                              <label for="robotConfigSelect" class="form-label">Robot Config File</label>
                              <select id="robotConfigSelect" class="form-select" name="robot_config"></select>
                            </div>   

                            <label for="evalPolicyPath" class="form-label">Pretrained Policy Path</label>
                            <input type="text" id="evalPolicyPath" name="policy_path" class="form-control" aria-describedby="recordHelpline" value="">
                            <div id="evalPolicyPathHelpBlock" class="form-text">
                              e.g - outputs/train/act_so100_test/checkpoints/last/pretrained_model
                            </div>
                            
                            <hr>

                            <div class="container mb-2 d-flex flex-wrap">

                              <div class="form-check form-switch me-2">
                                <input class="form-check-input" name="record_episodes" type="checkbox" role="switch" id="evalRecordEpisodes">
                                <label class="form-check-label" for="evalRecordEpisodes">Record Eval Episodes</label>
                              </div>
  
                              <div class="form-check form-switch mb-3">
                                <input class="form-check-input" name="push_to_hub" type="checkbox" role="switch" id="evalPushToHub">
                                <label class="form-check-label" for="evalPushToHub">Push To Hub</label>
                              </div>
  
                            </div> 
  
                            <label for="evalRoot" class="form-label">Root Dir</label>
                            <input type="text" id="evalRoot" name="root_dir" class="form-control" aria-describedby="evalHelpline" value="data/eval_test">

                            <label for="evalRepoID" class="form-label mt-2">Repo ID</label>
                            <input type="text" id="evalRepoID" name="repo_id" class="form-control" aria-describedby="evalHelpline" value="data/eval_test">
  
                            <label for="evalTags" class="form-label mt-2">Tags</label>
                            <input type="text" id="evalTags" name="tags" class="form-control" aria-describedby="evalHelpline" value="">
  
                            <label for="evalSingleTask" class="form-label mt-2">Single Task Desc</label>
                            <input type="text" id="evalSingleTask" name="single_task" class="form-control" aria-describedby="evalHelpline" value="">
  
                            <label for="evalNumEpisodes" class="form-label mt-2">Num Episodes</label>
                            <input type="number" id="evalNumEpisodes" name="num_episodes" class="form-control" aria-describedby="number of episodes" value="50">
                            
                            <label for="evalWarmupTime" class="form-label mt-2">Warmup Time</label>
                            <input type="number" id="evalWarmupTime" name="warmup_time_s" class="form-control" aria-describedby="warmup time" value="5">
                            
                            <hr>                            
  
                            <div class="input-group mb-3">
                              <span class="input-group-text">Max Episode Time</span>
                              <input type="number" class="form-control" id="evalEpisodeTime" name="episode_time_s" value="40" aria-label="episode time">
                              <span class="input-group-text">FPS</span>
                              <input type="number" class="form-control" id="evalFPS" name="fps" value="30" aria-label="frames per second">
                            </div>
  
                            
  
                            <div class="input-group mb-3">
                              <span class="input-group-text">Image Writer Processes</span>
                              <input type="number" class="form-control" id="evalImageWriterProcesses" name="num_image_writer_processes" value="0" aria-label="number of processes for image writer">
                              <span class="input-group-text">Writer Threads</span>
                              <input type="number" class="form-control" id="evalImageWriterThreads" name="num_image_writer_threads_per_camera" value="4" aria-label="number of threads for image writer">
                            </div>
  
  
                            <button type="submit" class="btn btn-primary">Apply</button>
  
                          </form>
  
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
    
                <!-- TODO: Implement -->
                <div class="tab-pane fade" id="replay-tab-pane" role="tabpanel" aria-labelledby="replay-tab" tabindex="3">...</div>
                <div class="tab-pane fade" id="calibrate-tab-pane" role="tabpanel" aria-labelledby="calibrate-tab" tabindex="4">...</div>

            </div>
          </div>
        </div>
  
        <div class="col-6" style="margin-top: 60px;">
          
          <div class="card" style="background-color: var(--bs-gray-800)!important">
            <div class="card-header">
              Logs
            </div>
            <div class="card-body">
              <div id="logsDisplay" style="overflow: scroll; min-height: 300px; max-height: 400px; font-size: 14px;">
                <p>No messages logged</p>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    

    <script src="js/app.js"></script>  
    <script src="js/teleop_panel.js"></script> 
    <script src="js/record_panel.js"></script>
    <script src="js/evaluate_panel.js"></script>
</body>
</html>